exports.id=1532,exports.ids=[1532],exports.modules={82139:(e,s,t)=>{Promise.resolve().then(t.bind(t,70578))},70578:(e,s,t)=>{"use strict";t.d(s,{UserManagementClient:()=>z});var r=t(10326),i=t(17577),a=t.n(i),l=t(35047),n=t(29752),o=t(91664),d=t(41190),c=t(44794),m=t(82015),h=t(29280),u=t(50384),x=t(77506),j=t(42160),p=t(69508),f=t(98091),g=t(74975),b=t(50949),v=t(18986),N=t(24061),S=t(30361),w=t(69669),y=t(5932),I=t(84097),C=t(74723),P=t(74064),F=t(14615),E=t(47943),D=t(78062),A=t(41156),T=t(12727),U=t(76025),k=t(76),Z=t(38443),O=t(51223),L=t(55296),B=t(24118);async function R(e,s){try{let t=await fetch("/api/send-email",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({to:e.email,subject:"You have been invited to the School Digital Platform",body:`
Hello ${e.name},

You have been invited to join the School Digital Platform with the following details:

Role: ${e.role}
School ID: ${e.schoolId||"N/A"}
Temporary Password: ${e.password}

Please log in at the following URL and change your password upon your first login:
${s}

Thank you,
Platform Administrator
                `.trim()})});if(!t.ok){let e=await t.json();throw Error(e.error||"Failed to send email")}return{success:!0}}catch(e){return{success:!1,error:e instanceof Error?e.message:"Unknown email error"}}}async function $(e,s){if(!U.db)throw Error("Firestore not configured.");let t=(0,k.JU)((0,k.hJ)(U.db,"invites"));await (0,k.pl)(t,{email:e.email,role:e.role,schoolId:e.schoolId||null,status:"pending",createdAt:new Date().toISOString()});let r=await R(e,s);return r.success?{success:!0,message:`Invite sent to ${e.email}.`}:{success:!0,message:`Invite for ${e.email} created, but failed to send email: ${r.error}`}}async function V(e,s){if(!U.db)throw Error("Firestore not configured.");let t=[],r=[];for(let i of e)try{let e=(0,k.JU)((0,k.hJ)(U.db,"invites"));await (0,k.pl)(e,{email:i.email,role:i.role,schoolId:i.schoolId||null,status:"pending",createdAt:new Date().toISOString()});let a=await R(i,s);a.success?t.push(i):r.push({data:i.email,reason:`Invite created but email failed: ${a.error}`})}catch(e){r.push({data:i.email,reason:"Firestore write failed"})}return{success:!0,message:`Processed ${e.length} users.`,report:{success:t,failed:r}}}async function Y(){return U.db&&U.W?(await (0,k.PL)((0,k.hJ)(U.db,"schools"))).docs.map(e=>({id:e.id,name:e.data().name})):[]}async function M(){if(!U.db||!U.W)return[];let e=(0,k.IO)((0,k.hJ)(U.db,"emailHistory"),(0,k.Xo)("sentAt","desc"),(0,k.b9)(10));return(await (0,k.PL)(e)).docs.map(e=>{let s=e.data();return{id:e.id,recipient:s.recipient,subject:s.subject,status:s.status,error:s.error,sentAt:s.sentAt instanceof k.EK?s.sentAt.toDate().toLocaleString():new Date().toLocaleString()}})}async function J(e){if(!U.db)throw Error("Firestore is not configured.");let s=(0,k.hJ)(U.db,"staff"),t=e?(0,k.IO)(s,(0,k.ar)("schoolId","==",e)):(0,k.IO)(s);return(await (0,k.PL)(t)).docs.map(e=>{let s=e.data();return{id:e.id,staffId:s.staffId,tpfNumber:s.tpfNumber,name:s.name,role:s.role,position:s.position,department:s.department,status:s.status,email:s.email,phone:s.phone,schoolId:s.schoolId,createdAt:s.createdAt instanceof k.EK?s.createdAt.toDate().toISOString():new Date().toISOString(),updatedAt:s.updatedAt instanceof k.EK?s.updatedAt.toDate().toISOString():new Date().toISOString()}})}async function Q(e,s){if(!U.db)throw Error("Firestore not configured.");let t=(0,k.JU)(U.db,"staff",e);await (0,k.r7)(t,{...s,updatedAt:(0,k.Bt)()})}async function G(e){if(!U.db)throw Error("Firestore not configured.");await (0,k.oe)((0,k.JU)(U.db,"staff",e))}function z(){let{toast:e}=(0,I.pm)();(0,l.useRouter)();let s=(0,l.useSearchParams)(),[t,U]=(0,i.useState)(null),[k,R]=(0,i.useState)([]),[z,W]=(0,i.useState)(null),[_,H]=(0,i.useState)(null),[K,q]=(0,i.useState)(null),[X,ee]=(0,i.useState)([]),[es,et]=(0,i.useState)(""),[er,ei]=(0,i.useState)(!1),[ea,el]=(0,i.useState)([]),[en,eo]=(0,i.useState)("idle"),[ed,ec]=(0,i.useState)(!0),[em,eh]=(0,i.useState)(null),[eu,ex]=(0,i.useState)(!1),ej=s?s.get("schoolId"):null,ep=(0,C.cI)({resolver:(0,P.F)(F.r),defaultValues:{name:"",email:"",phone:"",role:"teacher",schoolId:"none",password:""}}),ef=(0,C.cI)({resolver:(0,P.F)(E.F)}),[eg,eb]=(0,i.useState)(""),ev=(0,i.useCallback)(async()=>{let s=localStorage.getItem("userRole"),t=localStorage.getItem("schoolId");if(!s){ec(!1);return}ec(!0);try{let[e,r,i]=await Promise.all([Y(),M(),J("system-admin"===s?void 0:t)]);ee(e),el(r),R(i)}catch(s){e({variant:"destructive",title:"Error",description:"Could not load initial page data from Firestore."})}finally{ec(!1)}},[e]),eN=(0,i.useMemo)(()=>"system-admin"===_?ej?k.filter(e=>e.schoolId===ej):k:k.filter(e=>e.schoolId===K),[k,_,K,ej]),eS=a().useMemo(()=>F.I.filter(e=>"system-admin"!==e),[]),ew=async s=>{let t="system-admin"===_?s.schoolId:K;if(!t||"none"===t){e({variant:"destructive",title:"Error",description:"A school must be selected."});return}let r=window.location.origin,i=await $({...s,schoolId:t},r);i.success?(e({title:"Success",description:i.message}),ev(),ep.reset()):e({variant:"destructive",title:"Error",description:i.message})},ey=async s=>{if(s.preventDefault(),t){e({title:"File Upload Not Implemented",description:"This is a placeholder for server-side file processing."});return}let r=eg.split("\n").filter(e=>""!==e.trim());if(0===r.length){e({variant:"destructive",title:"Input Required",description:"Please provide user data."});return}let i=[],a=[];if(r.forEach(e=>{let[s,t,r,l,n,o]=e.split(",").map(e=>e.trim()),d="system-admin"===_?n:K,c=eS.includes(l)?l:void 0,m=F.r.safeParse({name:s,email:t,phone:r,role:c,schoolId:d,password:o});m.success?i.push(m.data):a.push({data:e,reason:m.error.errors.map(e=>e.message).join(", ")})}),0===i.length&&a.length>0){e({variant:"destructive",title:"Validation Failed",description:`No valid user entries found. Error: ${a[0].reason}`});return}let l=window.location.origin,n=await V(i,l);n.success?(ev(),e({title:"Batch Processed",description:`Invited ${n.report.success.length} users. Failed: ${a.length+n.report.failed.length}.`}),eb("")):e({variant:"destructive",title:"Batch Error",description:n.message})},eI=async s=>{if(em)try{await Q(em.id,s),e({title:"Staff Member Updated",description:`${s.name}'s details have been saved.`}),ev(),ex(!1)}catch(s){e({variant:"destructive",title:"Update Error",description:"Could not update staff record."})}},eC=async s=>{try{await G(s.id),e({title:"User Deleted",description:`${s.name}'s record has been deleted.`}),ev()}catch(s){e({variant:"destructive",title:"Delete Error",description:"Could not delete user record."})}},eP=e=>{eh(e);let{id:s,createdAt:t,updatedAt:r,...i}=e;ef.reset(i),ex(!0)},eF=async()=>{if(!es||!/^\S+@\S+\.\S+$/.test(es)){e({variant:"destructive",title:"Invalid Email",description:"Please enter a valid email address."});return}ei(!0),e({title:"Sending Test Email...",description:`Sending to ${es}.`});try{let s=await fetch("/api/send-email",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({to:es,subject:"Test Email from Digital Platform",body:"This is a test to confirm the email connection is working."})});if(!s.ok)throw Error((await s.json()).error||"API request failed");e({title:"Email Sent Successfully!",description:"Email sent via configured SMTP service."})}catch(s){e({variant:"destructive",title:"Connection Failed",description:s instanceof Error?s.message:"An unknown error occurred."})}finally{await ev(),ei(!1)}},eE=()=>{eo("connecting"),e({title:"Connecting to Google...",description:"Please wait. This is a simulation."}),setTimeout(()=>{let s=Math.random()>.3;eo(s?"connected":"error"),e({title:s?"Connection Successful!":"Connection Failed",description:s?"Your Google account is connected.":"Could not connect. Please try again.",variant:s?"default":"destructive"})},2e3)},eD=async s=>{try{let t=await fetch("/api/emails/delete",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:s})});if(!t.ok)throw Error((await t.json()).error||"Failed to delete log.");e({title:"Log Deleted",description:"Email history entry removed."}),ev()}catch(s){e({variant:"destructive",title:"Delete Failed",description:s instanceof Error?s.message:"Could not delete log."})}};return null===z||ed?r.jsx("div",{className:"flex items-center justify-center min-h-screen",children:r.jsx(x.Z,{className:"h-8 w-8 animate-spin text-primary"})}):z?(0,r.jsxs)(r.Fragment,{children:[r.jsx(T.m,{title:"Invite & Manage Users",description:"Add new users, manage existing user roles and details."}),(0,r.jsxs)(u.mQ,{defaultValue:"manage",className:"w-full",children:[(0,r.jsxs)(u.dr,{className:"grid w-full grid-cols-3",children:[r.jsx(u.SP,{value:"manage",children:"Manage Staff"}),r.jsx(u.SP,{value:"invite",children:"Invite Users"}),r.jsx(u.SP,{value:"email",children:"Email Settings"})]}),r.jsx(u.nU,{value:"manage",className:"mt-6",children:(0,r.jsxs)(n.Zb,{children:[(0,r.jsxs)(n.Ol,{children:[r.jsx(n.ll,{children:"Staff Directory"}),r.jsx(n.SZ,{children:"View and manage all registered staff in the system."})]}),r.jsx(n.aY,{children:r.jsx("div",{className:"overflow-x-auto rounded-md border",children:(0,r.jsxs)(A.iA,{children:[r.jsx(A.xD,{children:(0,r.jsxs)(A.SC,{children:[r.jsx(A.ss,{children:"Name"}),r.jsx(A.ss,{children:"Email"}),r.jsx(A.ss,{children:"Phone"}),r.jsx(A.ss,{children:"TPF Number"}),r.jsx(A.ss,{children:"Role"}),"system-admin"===_&&r.jsx(A.ss,{children:"School ID"}),r.jsx(A.ss,{className:"text-right",children:"Actions"})]})}),r.jsx(A.RM,{children:eN.length>0?eN.map(s=>(0,r.jsxs)(A.SC,{children:[r.jsx(A.pj,{className:"font-medium",children:s.name}),r.jsx(A.pj,{children:s.email}),r.jsx(A.pj,{children:s.phone}),r.jsx(A.pj,{children:s.tpfNumber}),r.jsx(A.pj,{children:r.jsx(Z.C,{variant:"secondary",children:s.role})}),"system-admin"===_&&r.jsx(A.pj,{children:s.schoolId||"N/A"}),(0,r.jsxs)(A.pj,{className:"text-right space-x-1",children:[r.jsx(o.Button,{variant:"ghost",size:"icon",title:"View Details",onClick:()=>e({title:"Feature Pending",description:"This will show a detailed user view."}),children:r.jsx(j.Z,{className:"h-4 w-4"})}),r.jsx(o.Button,{variant:"ghost",size:"icon",title:"Edit User",onClick:()=>eP(s),children:r.jsx(p.Z,{className:"h-4 w-4"})}),(0,r.jsxs)(L.aR,{children:[r.jsx(L.vW,{asChild:!0,children:r.jsx(o.Button,{variant:"ghost",size:"icon",title:"Delete User",children:r.jsx(f.Z,{className:"h-4 w-4 text-destructive"})})}),(0,r.jsxs)(L._T,{children:[(0,r.jsxs)(L.fY,{children:[r.jsx(L.f$,{children:"Are you sure?"}),(0,r.jsxs)(L.yT,{children:["This will delete ",s.name,"'s record from the staff list. It will NOT delete their authentication record. This action cannot be undone."]})]}),(0,r.jsxs)(L.xo,{children:[r.jsx(L.le,{children:"Cancel"}),r.jsx(L.OL,{onClick:()=>eC(s),className:"bg-destructive hover:bg-destructive/90",children:"Yes, Delete Record"})]})]})]})]})]},s.id)):r.jsx(A.SC,{children:r.jsx(A.pj,{colSpan:"system-admin"===_?7:6,className:"text-center h-24",children:"No users found."})})})]})})})]})}),r.jsx(u.nU,{value:"invite",className:"mt-6",children:r.jsx(n.Zb,{className:"shadow-xl rounded-lg",children:r.jsx(n.aY,{className:"pt-6",children:(0,r.jsxs)(u.mQ,{defaultValue:"single",className:"w-full",children:[(0,r.jsxs)(u.dr,{className:"grid w-full grid-cols-2",children:[r.jsx(u.SP,{value:"single",children:"Invite Single User"}),r.jsx(u.SP,{value:"multiple",children:"Invite Multiple Users"})]}),r.jsx(u.nU,{value:"single",className:"mt-6",children:(0,r.jsxs)("form",{onSubmit:ep.handleSubmit(ew),className:"space-y-6",children:[(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,r.jsxs)("div",{children:[r.jsx(c.Label,{htmlFor:"name",children:"Full Name"}),r.jsx(d.I,{id:"name",...ep.register("name")}),ep.formState.errors.name&&r.jsx("p",{className:"text-destructive text-xs mt-1",children:ep.formState.errors.name.message})]}),(0,r.jsxs)("div",{children:[r.jsx(c.Label,{htmlFor:"email",children:"Email Address"}),r.jsx(d.I,{id:"email",type:"email",...ep.register("email")}),ep.formState.errors.email&&r.jsx("p",{className:"text-destructive text-xs mt-1",children:ep.formState.errors.email.message})]}),(0,r.jsxs)("div",{children:[r.jsx(c.Label,{htmlFor:"phone",children:"Phone Number (Optional)"}),r.jsx(d.I,{id:"phone",type:"tel",...ep.register("phone")}),ep.formState.errors.phone&&r.jsx("p",{className:"text-destructive text-xs mt-1",children:ep.formState.errors.phone.message})]}),(0,r.jsxs)("div",{children:[r.jsx(c.Label,{htmlFor:"role",children:"Role"}),r.jsx(C.Qr,{name:"role",control:ep.control,render:({field:e})=>(0,r.jsxs)(h.Ph,{onValueChange:e.onChange,value:e.value,children:[r.jsx(h.i4,{id:"role",children:r.jsx(h.ki,{placeholder:"Select a role"})}),r.jsx(h.Bw,{children:eS.map(e=>r.jsx(h.Ql,{value:e,children:e.replace("-"," ").replace(/\b\w/g,e=>e.toUpperCase())},e))})]})}),ep.formState.errors.role&&r.jsx("p",{className:"text-destructive text-xs mt-1",children:ep.formState.errors.role.message})]}),"system-admin"===_&&(0,r.jsxs)("div",{children:[r.jsx(c.Label,{htmlFor:"schoolId",children:"School"}),r.jsx(C.Qr,{name:"schoolId",control:ep.control,render:({field:e})=>(0,r.jsxs)(h.Ph,{onValueChange:e.onChange,value:e.value,children:[r.jsx(h.i4,{id:"schoolId",children:r.jsx(h.ki,{placeholder:"Select a school"})}),(0,r.jsxs)(h.Bw,{children:[r.jsx(h.Ql,{value:"none",children:"N/A (for System Admin)"}),X.length>0?X.map(e=>(0,r.jsxs)(h.Ql,{value:e.id,children:[e.name," (",e.id,")"]},e.id)):r.jsx("div",{className:"p-2 text-sm text-muted-foreground",children:"No schools found."})]})]})}),ep.formState.errors.schoolId&&r.jsx("p",{className:"text-destructive text-xs mt-1",children:ep.formState.errors.schoolId.message})]}),(0,r.jsxs)("div",{children:[r.jsx(c.Label,{htmlFor:"password",children:"Temporary Password"}),r.jsx(d.I,{id:"password",type:"password",...ep.register("password"),placeholder:"User will be prompted to change"}),ep.formState.errors.password&&r.jsx("p",{className:"text-destructive text-xs mt-1",children:ep.formState.errors.password.message})]})]}),(0,r.jsxs)(o.Button,{type:"submit",className:"w-full",disabled:ep.formState.isSubmitting,children:[ep.formState.isSubmitting?r.jsx(x.Z,{className:"mr-2 h-4 w-4 animate-spin"}):r.jsx(g.Z,{className:"mr-2 h-5 w-5"}),ep.formState.isSubmitting?"Sending Invite...":"Send Invite"]})]})}),r.jsx(u.nU,{value:"multiple",className:"mt-6",children:(0,r.jsxs)("form",{onSubmit:ey,className:"space-y-6",children:[(0,r.jsxs)(n.Zb,{className:"bg-amber-50 border-amber-300",children:[r.jsx(n.Ol,{children:(0,r.jsxs)(n.ll,{className:"font-headline text-base text-amber-800 flex items-center",children:[r.jsx(b.Z,{className:"mr-2 h-5 w-5"}),"Method 1: Paste CSV Data"]})}),(0,r.jsxs)(n.aY,{children:[(0,r.jsxs)("p",{className:"font-body text-sm text-amber-700",children:["Enter one user per line: ",r.jsx("code",{className:"font-mono bg-amber-200/50 px-1 py-0.5 rounded",children:"FullName,email@example.com,phone,role,schoolId,password"})]}),(0,r.jsxs)("p",{className:"font-body text-xs text-amber-600 mt-2",children:["Example: ",r.jsx("code",{className:"font-mono bg-amber-200/50 px-1 py-0.5 rounded",children:"John Doe,j.d@school.com,555-1234,teacher,SCH-001,pass123"})]}),"system-admin"!==_&&(0,r.jsxs)("p",{className:"font-body text-sm text-amber-700 mt-2",children:[r.jsx("strong",{children:"Note:"})," The `schoolId` column will be ignored. All users will be assigned to your school: ",r.jsx("strong",{children:K}),"."]})]})]}),(0,r.jsxs)("div",{children:[r.jsx(c.Label,{htmlFor:"usersData",children:"Users Data (CSV Format)"}),r.jsx(m.g,{id:"usersData",value:eg,onChange:e=>eb(e.target.value),rows:8,placeholder:"Jane Doe,jane.d@school.com,555-5678,teacher,SCH-001,newpass...",disabled:!!t})]}),(0,r.jsxs)("div",{className:"relative",children:[r.jsx(D.Z,{}),r.jsx("span",{className:"absolute left-1/2 -translate-x-1/2 -top-2.5 bg-card px-2 text-sm text-muted-foreground",children:"OR"})]}),(0,r.jsxs)(n.Zb,{className:"bg-blue-50 border-blue-200",children:[r.jsx(n.Ol,{children:(0,r.jsxs)(n.ll,{className:"font-headline text-base text-blue-800 flex items-center",children:[r.jsx(v.Z,{className:"mr-2 h-5 w-5"}),"Method 2: Upload a File"]})}),(0,r.jsxs)(n.aY,{children:[r.jsx(c.Label,{htmlFor:"file-upload",children:"Upload Excel, Word, or PDF"}),r.jsx(d.I,{id:"file-upload",type:"file",accept:".xlsx,.xls,.doc,.docx,.pdf",onChange:e=>{e.target.files&&e.target.files[0]&&(U(e.target.files[0]),eb(""))},disabled:!!eg}),r.jsx("p",{className:"font-body text-xs text-blue-600 mt-2",children:"The file would be processed on the server to create users."}),t&&(0,r.jsxs)("p",{className:"font-body text-sm mt-2 text-blue-800",children:["Selected: ",t.name]})]})]}),(0,r.jsxs)(o.Button,{type:"submit",className:"w-full",disabled:ep.formState.isSubmitting,children:[ep.formState.isSubmitting?r.jsx(x.Z,{className:"mr-2 h-4 w-4 animate-spin"}):r.jsx(N.Z,{className:"mr-2 h-5 w-5"}),ep.formState.isSubmitting?"Processing...":"Process & Invite Users"]})]})})]})})})}),r.jsx(u.nU,{value:"email",className:"mt-6",children:(0,r.jsxs)(n.Zb,{children:[(0,r.jsxs)(n.Ol,{children:[r.jsx(n.ll,{children:"Email Settings & Status"}),r.jsx(n.SZ,{children:"Configure and test your email sending service."})]}),(0,r.jsxs)(n.aY,{className:"space-y-6",children:[(0,r.jsxs)(n.Zb,{className:"border-blue-200",children:[r.jsx(n.Ol,{children:(0,r.jsxs)(n.ll,{className:"text-base flex items-center gap-2",children:[r.jsx("img",{src:"https://www.gstatic.com/images/branding/product/1x/google_g_standard_color_32dp.png",alt:"Google logo",className:"h-5 w-5"}),"Connect with Google (Simulation)"]})}),(0,r.jsxs)(n.aY,{children:[r.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"Connect your Google account to enable seamless integration. This is a simulation and does not create a real connection."}),"idle"===en&&r.jsx(o.Button,{onClick:eE,children:"Connect with Google"}),"connecting"===en&&(0,r.jsxs)(o.Button,{disabled:!0,children:[r.jsx(x.Z,{className:"mr-2 h-4 w-4 animate-spin"}),"Connecting..."]}),"connected"===en&&(0,r.jsxs)("div",{className:"flex items-center gap-4",children:[r.jsx(o.Button,{variant:"destructive",onClick:()=>{eo("idle"),e({title:"Disconnected",description:"Your Google account has been disconnected."})},children:"Disconnect"}),(0,r.jsxs)("div",{className:"flex items-center gap-2 text-green-600",children:[r.jsx(S.Z,{className:"h-4 w-4"}),r.jsx("span",{children:"Connected"})]})]}),"error"===en&&(0,r.jsxs)("div",{className:"flex items-center gap-4",children:[r.jsx(o.Button,{onClick:eE,children:"Try Again"}),(0,r.jsxs)("div",{className:"flex items-center gap-2 text-destructive",children:[r.jsx(w.Z,{className:"h-4 w-4"}),r.jsx("span",{children:"Connection Failed"})]})]})]})]}),(0,r.jsxs)(n.Zb,{children:[r.jsx(n.Ol,{children:r.jsx(n.ll,{className:"text-base",children:"Test Email Connection"})}),(0,r.jsxs)(n.aY,{className:"flex items-end gap-2",children:[(0,r.jsxs)("div",{className:"flex-grow",children:[r.jsx(c.Label,{htmlFor:"test-email",children:"Recipient Email"}),r.jsx(d.I,{id:"test-email",type:"email",placeholder:"test@example.com",value:es,onChange:e=>et(e.target.value)})]}),(0,r.jsxs)(o.Button,{onClick:eF,disabled:er,children:[er?r.jsx(x.Z,{className:"mr-2 h-4 w-4 animate-spin"}):r.jsx(y.Z,{className:"mr-2 h-4 w-4"}),"Send Test"]})]})]}),(0,r.jsxs)(n.Zb,{children:[r.jsx(n.Ol,{children:r.jsx(n.ll,{className:"text-base",children:"Email Sending History (Last 10)"})}),r.jsx(n.aY,{children:r.jsx("div",{className:"overflow-x-auto rounded-md border",children:(0,r.jsxs)(A.iA,{children:[r.jsx(A.xD,{children:(0,r.jsxs)(A.SC,{children:[r.jsx(A.ss,{children:"Date"}),r.jsx(A.ss,{children:"Recipient"}),r.jsx(A.ss,{children:"Subject"}),r.jsx(A.ss,{children:"Status"}),r.jsx(A.ss,{className:"text-right",children:"Actions"})]})}),r.jsx(A.RM,{children:ea.length>0?ea.map(e=>(0,r.jsxs)(A.SC,{children:[r.jsx(A.pj,{children:e.sentAt}),r.jsx(A.pj,{children:e.recipient}),r.jsx(A.pj,{children:e.subject}),(0,r.jsxs)(A.pj,{children:[r.jsx(Z.C,{variant:"Success"===e.status?"default":"destructive",className:(0,O.cn)("Success"===e.status&&"bg-green-600"),children:e.status}),"Failed"===e.status&&e.error&&r.jsx("p",{className:"text-xs text-destructive mt-1",children:e.error})]}),r.jsx(A.pj,{className:"text-right",children:(0,r.jsxs)(L.aR,{children:[r.jsx(L.vW,{asChild:!0,children:r.jsx(o.Button,{variant:"ghost",size:"icon",title:"Delete Log",children:r.jsx(f.Z,{className:"h-4 w-4 text-destructive"})})}),(0,r.jsxs)(L._T,{children:[(0,r.jsxs)(L.fY,{children:[r.jsx(L.f$,{children:"Are you sure?"}),r.jsx(L.yT,{children:"This will permanently delete this email log. This cannot be undone."})]}),(0,r.jsxs)(L.xo,{children:[r.jsx(L.le,{children:"Cancel"}),r.jsx(L.OL,{onClick:()=>eD(e.id),className:"bg-destructive hover:bg-destructive/90",children:"Yes, Delete Log"})]})]})]})})]},e.id)):r.jsx(A.SC,{children:r.jsx(A.pj,{colSpan:5,className:"text-center h-24",children:"No email history found."})})})]})})})]})]})]})})]}),r.jsx(B.Vq,{open:eu,onOpenChange:ex,children:(0,r.jsxs)(B.cZ,{children:[(0,r.jsxs)(B.fK,{children:[(0,r.jsxs)(B.$N,{children:["Edit Staff Member: ",em?.name]}),r.jsx(B.Be,{children:"Modify the user's details below. Password cannot be changed from this screen."})]}),(0,r.jsxs)("form",{onSubmit:ef.handleSubmit(eI),className:"space-y-4 pt-4",children:[(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{children:[r.jsx(c.Label,{htmlFor:"edit-name",children:"Full Name"}),r.jsx(d.I,{id:"edit-name",...ef.register("name")})]}),(0,r.jsxs)("div",{children:[r.jsx(c.Label,{htmlFor:"edit-email",children:"Email"}),r.jsx(d.I,{id:"edit-email",...ef.register("email")})]}),(0,r.jsxs)("div",{children:[r.jsx(c.Label,{htmlFor:"edit-phone",children:"Phone"}),r.jsx(d.I,{id:"edit-phone",...ef.register("phone")})]}),(0,r.jsxs)("div",{children:[r.jsx(c.Label,{htmlFor:"edit-tpfNumber",children:"TPF Number"}),r.jsx(d.I,{id:"edit-tpfNumber",...ef.register("tpfNumber")})]}),(0,r.jsxs)("div",{children:[r.jsx(c.Label,{htmlFor:"edit-position",children:"Position"}),r.jsx(d.I,{id:"edit-position",...ef.register("position")})]}),(0,r.jsxs)("div",{children:[r.jsx(c.Label,{htmlFor:"edit-role",children:"Role"}),r.jsx(C.Qr,{name:"role",control:ef.control,render:({field:e})=>(0,r.jsxs)(h.Ph,{onValueChange:e.onChange,value:e.value,children:[r.jsx(h.i4,{id:"edit-role",children:r.jsx(h.ki,{})}),r.jsx(h.Bw,{children:eS.map(e=>r.jsx(h.Ql,{value:e,children:e.replace("-"," ").replace(/\b\w/g,e=>e.toUpperCase())},e))})]})})]}),"system-admin"===_&&(0,r.jsxs)("div",{children:[r.jsx(c.Label,{htmlFor:"edit-schoolId",children:"School"}),r.jsx(C.Qr,{name:"schoolId",control:ef.control,render:({field:e})=>(0,r.jsxs)(h.Ph,{onValueChange:e.onChange,value:e.value,children:[r.jsx(h.i4,{id:"edit-schoolId",children:r.jsx(h.ki,{})}),(0,r.jsxs)(h.Bw,{children:[r.jsx(h.Ql,{value:"none",children:"N/A (for System Admin)"}),X.map(e=>(0,r.jsxs)(h.Ql,{value:e.id,children:[e.name," (",e.id,")"]},e.id))]})]})})]})]}),(0,r.jsxs)(B.cN,{children:[r.jsx(B.GG,{asChild:!0,children:r.jsx(o.Button,{type:"button",variant:"outline",children:"Cancel"})}),(0,r.jsxs)(o.Button,{type:"submit",disabled:ef.formState.isSubmitting,children:[ef.formState.isSubmitting?r.jsx(x.Z,{className:"mr-2 h-4 w-4 animate-spin"}):null,"Save Changes"]})]})]})]})})]}):null}},38443:(e,s,t)=>{"use strict";t.d(s,{C:()=>n});var r=t(10326);t(17577);var i=t(79360),a=t(51223);let l=(0,i.j)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function n({className:e,variant:s,...t}){return r.jsx("div",{className:(0,a.cn)(l({variant:s}),e),...t})}},78062:(e,s,t)=>{"use strict";t.d(s,{Z:()=>n});var r=t(10326),i=t(17577),a=t(17415),l=t(51223);let n=i.forwardRef(({className:e,orientation:s="horizontal",decorative:t=!0,...i},n)=>r.jsx(a.f,{ref:n,decorative:t,orientation:s,className:(0,l.cn)("shrink-0 bg-border","horizontal"===s?"h-[1px] w-full":"h-full w-[1px]",e),...i}));n.displayName=a.f.displayName},50384:(e,s,t)=>{"use strict";t.d(s,{SP:()=>d,dr:()=>o,mQ:()=>n,nU:()=>c});var r=t(10326),i=t(17577),a=t(62605),l=t(51223);let n=a.fC,o=i.forwardRef(({className:e,...s},t)=>r.jsx(a.aV,{ref:t,className:(0,l.cn)("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",e),...s}));o.displayName=a.aV.displayName;let d=i.forwardRef(({className:e,...s},t)=>r.jsx(a.xz,{ref:t,className:(0,l.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",e),...s}));d.displayName=a.xz.displayName;let c=i.forwardRef(({className:e,...s},t)=>r.jsx(a.VY,{ref:t,className:(0,l.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",e),...s}));c.displayName=a.VY.displayName},82015:(e,s,t)=>{"use strict";t.d(s,{g:()=>l});var r=t(10326),i=t(17577),a=t(51223);let l=i.forwardRef(({className:e,...s},t)=>r.jsx("textarea",{className:(0,a.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),ref:t,...s}));l.displayName="Textarea"},52024:(e,s,t)=>{"use strict";t.d(s,{$:()=>n});var r=t(68570);let i=(0,r.createProxy)(String.raw`C:\Users\Admin\Desktop\app\src\components\dashboard\user-management-client.tsx`),{__esModule:a,$$typeof:l}=i;i.default;let n=(0,r.createProxy)(String.raw`C:\Users\Admin\Desktop\app\src\components\dashboard\user-management-client.tsx#UserManagementClient`)},42117:(e,s,t)=>{"use strict";t.d(s,{m:()=>i});var r=t(19510);function i({title:e,description:s,children:t}){return(0,r.jsxs)("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between space-y-4 md:space-y-0 md:space-x-4",children:[(0,r.jsxs)("div",{className:"space-y-1",children:[r.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:e}),r.jsx("p",{className:"text-lg text-muted-foreground",children:s})]}),t&&r.jsx("div",{className:"flex-shrink-0",children:t})]})}t(71159)},94443:(e,s,t)=>{"use strict";t.d(s,{O:()=>a});var r=t(19510),i=t(40644);function a({className:e,...s}){return r.jsx("div",{className:(0,i.cn)("animate-pulse rounded-md bg-muted",e),...s})}},40644:(e,s,t)=>{"use strict";t.d(s,{cn:()=>a});var r=t(55761),i=t(62386);function a(...e){return(0,i.m6)((0,r.W)(e))}}};