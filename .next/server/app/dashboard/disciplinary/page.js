(()=>{var e={};e.id=2969,e.ids=[2969],e.modules={47849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},83122:e=>{"use strict";e.exports=require("undici")},6113:e=>{"use strict";e.exports=require("crypto")},9523:e=>{"use strict";e.exports=require("dns")},82361:e=>{"use strict";e.exports=require("events")},57147:e=>{"use strict";e.exports=require("fs")},13685:e=>{"use strict";e.exports=require("http")},85158:e=>{"use strict";e.exports=require("http2")},41808:e=>{"use strict";e.exports=require("net")},22037:e=>{"use strict";e.exports=require("os")},71017:e=>{"use strict";e.exports=require("path")},77282:e=>{"use strict";e.exports=require("process")},12781:e=>{"use strict";e.exports=require("stream")},24404:e=>{"use strict";e.exports=require("tls")},57310:e=>{"use strict";e.exports=require("url")},73837:e=>{"use strict";e.exports=require("util")},59796:e=>{"use strict";e.exports=require("zlib")},53367:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>n.a,__next_app__:()=>p,originalPathname:()=>u,pages:()=>c,routeModule:()=>m,tree:()=>o}),s(85752),s(13321),s(85070),s(35866);var r=s(23191),i=s(88716),a=s(37922),n=s.n(a),d=s(95231),l={};for(let e in d)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>d[e]);s.d(t,l);let o=["",{children:["dashboard",{children:["disciplinary",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,85752)),"C:\\Users\\Admin\\Desktop\\app\\app\\dashboard\\disciplinary\\page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,13321)),"C:\\Users\\Admin\\Desktop\\app\\app\\dashboard\\layout.tsx"]}]},{layout:[()=>Promise.resolve().then(s.bind(s,85070)),"C:\\Users\\Admin\\Desktop\\app\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,35866,23)),"next/dist/client/components/not-found-error"]}],c=["C:\\Users\\Admin\\Desktop\\app\\app\\dashboard\\disciplinary\\page.tsx"],u="/dashboard/disciplinary/page",p={require:s,loadChunk:()=>Promise.resolve()},m=new r.AppPageRouteModule({definition:{kind:i.x.APP_PAGE,page:"/dashboard/disciplinary/page",pathname:"/dashboard/disciplinary",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:o}})},41844:(e,t,s)=>{Promise.resolve().then(s.bind(s,39591))},39591:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>T});var r=s(10326),i=s(17577),a=s(29752),n=s(91664),d=s(41190),l=s(44794),o=s(82015),c=s(29280),u=s(9280),p=s(41156),m=s(13961),h=s(18986),x=s(64004),j=s(5932),g=s(31215),f=s(77506),v=s(82685),y=s(98091),b=s(84097),N=s(74723),D=s(74064),w=s(770);let I=["Bullying","Vandalism","Absenteeism","Lateness","Disrespect","Violence","Drug","Theft","Cheating","Other"],A=w.Ry({id:w.Z_(),schoolId:w.Z_(),userId:w.Z_(),incidentDate:w.Z_().min(1,"Incident date is required."),studentName:w.Z_().min(1,"Student name is required."),studentId:w.Z_().min(1,"Student ID is required."),studentDob:w.Z_().min(1,"Student Date of Birth is required."),studentYear:w.Z_().min(1,"Student year level is required."),issues:w.IX(w.Km(I)).nonempty("At least one issue must be selected."),drugType:w.Z_().optional(),otherIssue:w.Z_().optional(),comments:w.Z_().min(1,"Incident details/comments are required."),raisedBy:w.Z_().min(1,"Please specify who raised the issue."),parentsInformed:w.Km(["Yes","No","Attempted"]).optional(),actionComments:w.Z_().min(1,"Please describe the action taken."),createdAt:w.Z_().datetime().or(w.hT()),updatedAt:w.Z_().datetime().or(w.hT())}).omit({id:!0,schoolId:!0,userId:!0,createdAt:!0,updatedAt:!0}).refine(e=>!e.issues.includes("Drug")||!!e.drugType,{message:"Please specify the type of drug.",path:["drugType"]}).refine(e=>!e.issues.includes("Other")||!!e.otherIssue,{message:"Please describe the 'Other' issue.",path:["otherIssue"]});var S=s(24118),C=s(33261),k=s(38227),q=s(12727),Z=s(76025),_=s(76),F=s(76074),P=s(90434);async function R(e){if(!Z.db)throw Error("Firestore is not configured.");let t=(0,_.IO)((0,_.hJ)(Z.db,"disciplinary"),(0,_.ar)("schoolId","==",e));return(await (0,_.PL)(t)).docs.map(e=>{let t=e.data();return{...t,id:e.id,incidentDate:t.incidentDate,studentDob:t.studentDob,createdAt:t.createdAt instanceof _.EK?t.createdAt.toDate().toISOString():new Date(t.createdAt).toISOString(),updatedAt:t.updatedAt instanceof _.EK?t.updatedAt.toDate().toISOString():new Date(t.updatedAt).toISOString()}})}async function B(e,t){if(!Z.db)throw Error("Firestore is not configured.");if(t){let s=(0,_.JU)(Z.db,"disciplinary",t),r={...e,updatedAt:(0,_.Bt)()};return await (0,_.r7)(s,r),{...e,id:t,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()}}{let t={...e,createdAt:(0,_.Bt)(),updatedAt:(0,_.Bt)()},s=await (0,_.ET)((0,_.hJ)(Z.db,"disciplinary"),t);return{...e,id:s.id,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()}}}async function O(e){if(!Z.db)throw Error("Firestore is not configured.");await (0,_.oe)((0,_.JU)(Z.db,"disciplinary",e))}function T(){let{toast:e}=(0,b.pm)(),[t,s]=(0,i.useState)([]),[w,_]=(0,i.useState)(!0),[T,E]=(0,i.useState)(null),[L,Y]=(0,i.useState)(null),[U,M]=(0,i.useState)(!1),[V,$]=(0,i.useState)(null),[G,Q]=(0,i.useState)(null),X=(0,i.useCallback)(async()=>{if(!V){Z.W&&E("Your school ID is not set. Cannot load data."),_(!1);return}_(!0),E(null);try{let e=await R(V);s(e)}catch(e){E(e instanceof Error?e.message:"An unknown error occurred."),s([])}finally{_(!1)}},[V]),{register:z,handleSubmit:K,reset:J,control:W,watch:H,getValues:ee,formState:{errors:et,isSubmitting:es}}=(0,N.cI)({resolver:(0,D.F)(A),defaultValues:{incidentDate:"",studentName:"",studentId:"",studentDob:"",studentYear:"",issues:[],drugType:"",otherIssue:"",comments:"",raisedBy:"",parentsInformed:void 0,actionComments:""}}),er=H("issues"),ei=er.includes("Drug"),ea=er.includes("Other"),en=async t=>{if(!Z.W){e({variant:"destructive",title:"Action Disabled",description:"Cannot save because Firebase is not configured."});return}if(!V||!G){e({variant:"destructive",title:"Save Failed",description:"School ID or User ID not found."});return}let s={...t,schoolId:V,userId:G};try{await B(s,L??void 0),await X(),e({title:L?"Record Updated":"Record Saved",description:`Disciplinary record for ${t.studentName} has been processed.`}),M(!1),J()}catch(t){console.error("Error saving record to Firestore:",t),e({variant:"destructive",title:"Save Failed",description:"Could not save disciplinary record."})}},ed=e=>{Y(e),M(!0)},el=async t=>{if(window.confirm("Are you sure you want to delete this disciplinary record?")){if(!Z.W){e({variant:"destructive",title:"Action Disabled",description:"Cannot delete because Firebase is not configured."});return}try{await O(t),await X(),e({title:"Record Deleted",description:"The disciplinary record has been deleted."})}catch(t){console.error("Error deleting record from Firestore:",t),e({variant:"destructive",title:"Delete Failed",description:"Could not delete record."})}}},eo=()=>{e({title:"Printing...",description:"Use your browser's print dialog to save as PDF or print."}),window.print()};return(0,r.jsxs)("div",{className:"p-8 space-y-8",children:[r.jsx(q.m,{title:"Disciplinary Records",description:"Manage student disciplinary records and actions taken.",children:(0,r.jsxs)(n.Button,{onClick:()=>{Y(null),J(),M(!0)},children:[r.jsx(m.Z,{className:"mr-2 h-5 w-5"})," Add New Record"]})}),(0,r.jsxs)(C.bZ,{children:[r.jsx(h.Z,{className:"h-4 w-4"}),r.jsx(C.Cd,{children:"Bulk Data Upload"}),(0,r.jsxs)(C.X,{children:["To enter multiple disciplinary records at once, go to the"," ",r.jsx(P.default,{href:"/dashboard/operations/infodatafeed",className:"font-bold underline",children:"Info Data Feed"})," ",'page, download the "Disciplinary Records" template, fill it out, and upload it.']})]}),r.jsx(S.Vq,{open:U,onOpenChange:e=>{M(e),e||(Y(null),J())},children:(0,r.jsxs)(S.cZ,{className:"sm:max-w-lg md:max-w-xl lg:max-w-2xl",children:[r.jsx(S.fK,{children:r.jsx(S.$N,{className:"font-headline",children:L?"Edit Disciplinary Record":"New Record Entry"})}),r.jsx("div",{className:"printable-area",children:(0,r.jsxs)("form",{id:"disciplinary-form",onSubmit:K(en),className:"space-y-3 font-body max-h-[70vh] overflow-y-auto p-1 pr-3",children:[(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[(0,r.jsxs)("div",{children:[r.jsx(l.Label,{htmlFor:"incident-date",children:"Date of Incident"}),r.jsx(d.I,{type:"date",id:"incident-date",...z("incidentDate")}),et.incidentDate&&r.jsx("p",{className:"text-destructive text-xs mt-1",children:et.incidentDate.message})]}),(0,r.jsxs)("div",{children:[r.jsx(l.Label,{htmlFor:"student-name",children:"Student Name"}),r.jsx(d.I,{type:"text",id:"student-name",...z("studentName"),placeholder:"Full Name"}),et.studentName&&r.jsx("p",{className:"text-destructive text-xs mt-1",children:et.studentName.message})]}),(0,r.jsxs)("div",{children:[r.jsx(l.Label,{htmlFor:"student-id",children:"Student ID"}),r.jsx(d.I,{type:"text",id:"student-id",...z("studentId"),placeholder:"e.g., S12345"}),et.studentId&&r.jsx("p",{className:"text-destructive text-xs mt-1",children:et.studentId.message})]}),(0,r.jsxs)("div",{children:[r.jsx(l.Label,{htmlFor:"student-dob",children:"Date of Birth"}),r.jsx(d.I,{type:"date",id:"student-dob",...z("studentDob")}),et.studentDob&&r.jsx("p",{className:"text-destructive text-xs mt-1",children:et.studentDob.message})]}),(0,r.jsxs)("div",{children:[r.jsx(l.Label,{htmlFor:"student-year",children:"Year Level"}),r.jsx(N.Qr,{name:"studentYear",control:W,render:({field:e})=>r.jsx(F.d,{id:"student-year-select",value:e.value,onValueChange:e.onChange})}),et.studentYear&&r.jsx("p",{className:"text-destructive text-xs mt-1",children:et.studentYear.message})]})]}),(0,r.jsxs)("div",{children:[r.jsx(l.Label,{className:"mb-1 block",children:"Issues"}),r.jsx(N.Qr,{name:"issues",control:W,render:({field:e})=>r.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-x-4 gap-y-1",children:I.map(t=>(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[r.jsx(u.X,{id:`issue-${t.toLowerCase()}`,checked:e.value?.includes(t),onCheckedChange:s=>{let r=s?[...e.value||[],t]:(e.value||[]).filter(e=>e!==t);e.onChange(r)}}),r.jsx(l.Label,{htmlFor:`issue-${t.toLowerCase()}`,className:"font-normal",children:t})]},t))})}),et.issues&&r.jsx("p",{className:"text-destructive text-xs mt-1",children:et.issues.message})]}),ei&&(0,r.jsxs)("div",{children:[r.jsx(l.Label,{htmlFor:"drug-type",children:"Type of Drugs (if applicable)"}),r.jsx(d.I,{type:"text",id:"drug-type",...z("drugType"),placeholder:"e.g., Cannabis, Vape"}),et.drugType&&r.jsx("p",{className:"text-destructive text-xs mt-1",children:et.drugType.message})]}),ea&&(0,r.jsxs)("div",{children:[r.jsx(l.Label,{htmlFor:"other-issue",children:"Other Issue Description"}),r.jsx(o.g,{id:"other-issue",...z("otherIssue"),placeholder:"Describe the other issue in detail"}),et.otherIssue&&r.jsx("p",{className:"text-destructive text-xs mt-1",children:et.otherIssue.message})]}),(0,r.jsxs)("div",{children:[r.jsx(l.Label,{htmlFor:"comments",children:"Comments / Incident Details"}),r.jsx(o.g,{id:"comments",...z("comments"),placeholder:"Detailed description of the incident...",rows:2}),et.comments&&r.jsx("p",{className:"text-destructive text-xs mt-1",children:et.comments.message})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[(0,r.jsxs)("div",{children:[r.jsx(l.Label,{htmlFor:"raised-by",children:"Issue Raised By"}),r.jsx(d.I,{type:"text",id:"raised-by",...z("raisedBy"),placeholder:"Name of reporter"}),et.raisedBy&&r.jsx("p",{className:"text-destructive text-xs mt-1",children:et.raisedBy.message})]}),(0,r.jsxs)("div",{children:[r.jsx(l.Label,{htmlFor:"parents-informed",children:"Parents Informed"}),r.jsx(N.Qr,{name:"parentsInformed",control:W,render:({field:e})=>(0,r.jsxs)(c.Ph,{onValueChange:e.onChange,value:e.value,children:[r.jsx(c.i4,{id:"parents-informed",children:r.jsx(c.ki,{placeholder:"Select status"})}),(0,r.jsxs)(c.Bw,{children:[r.jsx(c.Ql,{value:"Yes",children:"Yes"}),r.jsx(c.Ql,{value:"No",children:"No"}),r.jsx(c.Ql,{value:"Attempted",children:"Attempted, No Response"})]})]})}),et.parentsInformed&&r.jsx("p",{className:"text-destructive text-xs mt-1",children:et.parentsInformed.message})]})]}),(0,r.jsxs)("div",{children:[r.jsx(l.Label,{htmlFor:"action-comments",children:"Action Taken / Next Steps"}),r.jsx(o.g,{id:"action-comments",...z("actionComments"),placeholder:"Describe actions taken...",rows:2}),et.actionComments&&r.jsx("p",{className:"text-destructive text-xs mt-1",children:et.actionComments.message})]})]})}),(0,r.jsxs)(S.cN,{className:"pt-3 print:hidden flex-wrap justify-center sm:justify-end gap-2",children:[(0,r.jsxs)(n.Button,{type:"button",variant:"outline",onClick:eo,children:[r.jsx(x.Z,{className:"mr-2 h-4 w-4"})," Print Form"]}),(0,r.jsxs)(n.Button,{type:"button",variant:"outline",onClick:()=>{e({title:"Emailing Record (Simulated)",description:"An email would be sent to the relevant parties."})},children:[r.jsx(j.Z,{className:"mr-2 h-4 w-4"})," Email Form"]}),(0,r.jsxs)(n.Button,{type:"button",variant:"secondary",onClick:()=>{console.log("Saving draft (simulated):",ee()),e({title:"Draft Saved",description:"Your disciplinary record draft has been saved (simulated)."})},disabled:es,children:[r.jsx(g.Z,{className:"mr-2 h-4 w-4"})," Save Draft"]}),r.jsx(S.GG,{asChild:!0,children:r.jsx(n.Button,{type:"button",variant:"outline",children:"Cancel"})}),(0,r.jsxs)(n.Button,{type:"submit",form:"disciplinary-form",disabled:es,children:[es?r.jsx(f.Z,{className:"mr-2 h-4 w-4 animate-spin"}):r.jsx(g.Z,{className:"mr-2 h-4 w-4"}),L?"Update Record":"Save Record"]})]})]})}),(0,r.jsxs)("div",{className:"printable-area",children:[!w&&!T&&t.length>0&&(0,r.jsxs)(a.Zb,{id:"preview-section",className:"p-4 mt-8",children:[r.jsx(a.Ol,{children:(0,r.jsxs)(a.ll,{className:"text-2xl font-headline",children:["All Disciplinary Records (",t.length,")"]})}),(0,r.jsxs)(a.aY,{children:[r.jsx("div",{className:"overflow-x-auto",children:(0,r.jsxs)(p.iA,{children:[r.jsx(p.xD,{children:(0,r.jsxs)(p.SC,{children:[r.jsx(p.ss,{children:"Date"}),r.jsx(p.ss,{children:"Name"}),r.jsx(p.ss,{children:"ID"}),r.jsx(p.ss,{children:"Year"}),r.jsx(p.ss,{children:"Issues"}),r.jsx(p.ss,{className:"print:hidden",children:"Actions"})]})}),r.jsx(p.RM,{children:t.map(e=>(0,r.jsxs)(p.SC,{children:[r.jsx(p.pj,{children:e.incidentDate}),r.jsx(p.pj,{children:e.studentName}),r.jsx(p.pj,{children:e.studentId}),r.jsx(p.pj,{children:e.studentYear}),(0,r.jsxs)(p.pj,{children:[e.issues.join(", "),e.issues.includes("Drug")&&e.drugType&&` (${e.drugType})`,e.issues.includes("Other")&&e.otherIssue&&` (${e.otherIssue})`]}),(0,r.jsxs)(p.pj,{className:"space-x-1 print:hidden",children:[r.jsx(n.Button,{variant:"ghost",size:"icon",onClick:()=>e.id&&ed(e.id),title:"Edit Record",children:r.jsx(v.Z,{className:"h-4 w-4"})}),r.jsx(n.Button,{variant:"ghost",size:"icon",onClick:()=>e.id&&el(e.id),title:"Delete Record",children:r.jsx(y.Z,{className:"h-4 w-4 text-destructive"})})]})]},e.id))})]})}),(0,r.jsxs)(n.Button,{onClick:eo,className:"w-full sm:w-auto mt-6 print:hidden",children:[r.jsx(x.Z,{className:"mr-2 h-5 w-5"})," Print Records"]})]})]}),!w&&!T&&0===t.length&&(0,r.jsxs)(a.Zb,{className:"mt-6 bg-muted/30 print:hidden",children:[r.jsx(a.Ol,{children:r.jsx(a.ll,{className:"text-base flex items-center",children:"No Disciplinary Records"})}),r.jsx(a.aY,{children:r.jsx("p",{className:"text-sm text-foreground",children:"No disciplinary records found for this school. Add one to get started."})})]}),w&&r.jsx("div",{className:"space-y-2",children:r.jsx(k.O,{className:"h-40 w-full"})}),T&&r.jsx(a.Zb,{className:"bg-destructive/10 text-destructive p-4",children:T})]})]})}},18986:(e,t,s)=>{"use strict";s.d(t,{Z:()=>r});/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,s(62881).Z)("FileUp",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M12 12v6",key:"3ahymv"}],["path",{d:"m15 15-3-3-3 3",key:"15xj92"}]])},33261:(e,t,s)=>{"use strict";s.d(t,{Cd:()=>o,X:()=>c,bZ:()=>l});var r=s(10326),i=s(17577),a=s(79360),n=s(51223);let d=(0,a.j)("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),l=i.forwardRef(({className:e,variant:t,...s},i)=>r.jsx("div",{ref:i,role:"alert",className:(0,n.cn)(d({variant:t}),e),...s}));l.displayName="Alert";let o=i.forwardRef(({className:e,...t},s)=>r.jsx("h5",{ref:s,className:(0,n.cn)("mb-1 font-medium leading-none tracking-tight",e),...t}));o.displayName="AlertTitle";let c=i.forwardRef(({className:e,...t},s)=>r.jsx("div",{ref:s,className:(0,n.cn)("text-sm [&_p]:leading-relaxed",e),...t}));c.displayName="AlertDescription"},9280:(e,t,s)=>{"use strict";s.d(t,{X:()=>l});var r=s(10326),i=s(17577),a=s(12090),n=s(32933),d=s(51223);let l=i.forwardRef(({className:e,...t},s)=>r.jsx(a.fC,{ref:s,className:(0,d.cn)("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",e),...t,children:r.jsx(a.z$,{className:(0,d.cn)("flex items-center justify-center text-current"),children:r.jsx(n.Z,{className:"h-4 w-4"})})}));l.displayName=a.fC.displayName},85752:(e,t,s)=>{"use strict";s.r(t),s.d(t,{$$typeof:()=>n,__esModule:()=>a,default:()=>d});var r=s(68570);let i=(0,r.createProxy)(String.raw`C:\Users\Admin\Desktop\app\app\dashboard\disciplinary\page.tsx`),{__esModule:a,$$typeof:n}=i;i.default;let d=(0,r.createProxy)(String.raw`C:\Users\Admin\Desktop\app\app\dashboard\disciplinary\page.tsx#default`)}};var t=require("../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),r=t.X(0,[8537,434,3121,9082,5426,9131,770,4064,7297,8578,4476],()=>s(53367));module.exports=r})();